<div class="container-wrapper">
  <div class="flex-header">
    <h1 class="dashboard-title">Dashboard</h1>
  </div>

  <div class="status-cards">
    <mat-card class="status-card total">
      <mat-card-header class="centered-flexbox">
        <mat-icon mat-card-avatar class="centered-logo">devices</mat-icon>
      </mat-card-header>
      <mat-card-content class="card-content">
        <span class="count">{{ projects().length }}</span>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card stopped">
      <mat-card-header>
        <mat-icon mat-card-avatar class="centered-logo">stop</mat-icon>
        <mat-card-title>Stopped</mat-card-title>
      </mat-card-header>
      <mat-card-content class="card-content">
        <span class="count">{{ containerStats().stopped }}</span>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card updated">
      <mat-card-header>
        <mat-icon mat-card-avatar class="centered-logo">check_circle</mat-icon>
        <mat-card-title>Running</mat-card-title>
      </mat-card-header>
      <mat-card-content class="card-content">
        <span class="count">{{ containerStats().running }}</span>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card needs-update">
      <mat-card-header>
        <mat-icon mat-card-avatar class="centered-logo">new_releases</mat-icon>
        <mat-card-title class="text-sm">Updates</mat-card-title>
      </mat-card-header>
      <mat-card-content class="card-content">
        <span class="count">{{ containerStats().needsUpdate }}</span>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card updating">
      <mat-card-header>
        <mat-icon mat-card-avatar class="centered-logo">loop</mat-icon>
        <mat-card-title>Updating</mat-card-title>
      </mat-card-header>
      <mat-card-content class="card-content">
        <span class="count">{{ containerStats().updating }}</span>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card failed">
      <mat-card-header>
        <mat-icon mat-card-avatar class="centered-logo">error</mat-icon>
        <mat-card-title>Failed</mat-card-title>
      </mat-card-header>
      <mat-card-content class="card-content">
        <span class="count">{{ containerStats().failed }}</span>
      </mat-card-content>
    </mat-card>
  </div>

  @if (!dashboardStore.loading()) {
  <div class="container-list">
    @for (project of projects(); track project.name) {
    <mat-card appearance="outlined">
      <mat-card-header>
        <mat-icon mat-card-avatar class="centered-logo">
          {{ getStatusIcon(project?.containers?.[0]?.state) }}
        </mat-icon>
        <mat-card-title>{{ project.name }}</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>Containers: {{ getRunningCount(project) }}/{{ getTotalCount(project) }} running</p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button [routerLink]="['/project', project.name]">View</button>
        <button mat-button [routerLink]="['/edit-project', project.name]">Edit</button>
      </mat-card-actions>
    </mat-card>
    }

    @if (projects().length === 0) {
    <mat-card class="empty-state">
      <mat-card-content>
        <p>No compose stacks found. Add your first compose stack to get started.</p>
        <app-create-project-button />
      </mat-card-content>
    </mat-card>
    }
  </div>
  }

  @if (dashboardStore.loading()) {
  <div class="loading-state">
    <p>Loading compose stacks...</p>
  </div>
  }

  <!-- @if (error()) {
    <div class="error-state">
      <p>Error loading containers: {{ error() }}</p>
      <button mat-button (click)="loadContainers()">Retry</button>
    </div>
  } -->
</div>
